# NCE

## Model

### data distr.

$D=1$​​​ x in data $p_d$, =0 x generated by contrasive noise $p_n$

| X     | D    |
| ----- | ---- |
| $x$ (data)  | 1    |
| $x_n$ (noise) | 0    |


Likelihood:
$$
l(\theta)=\sum \ln h(x^{(d)}_i) +\sum \ln (1-h(x^{(n)}_i))\\
h(u; θ) = r_\nu  (G(u; θ)) ; G(u; θ) = \ln p_d - \ln p_n
$$

NCE-likelihood:
$p_m(x;\theta)=p_0(x;\alpha)+c$ where $\theta=(\alpha,c)$ without any normalization constraint for $c$, but assume $\exists \theta, p_m(x;\theta)=p_d(x)$

after learning, $\hat{c}=-\ln Z(\hat\alpha)$

### obj. function

$$
J_T(\theta):=\frac{1}{N_d}(\sum \ln h(x^{(d)}_i) +\sum \ln (1-h(x^{(n)}_i)))\\
\rightarrow (prob.)\\
J(\theta):=E_d \ln h(x) +\nu E_n\ln (1-h(x))
$$


*nonparametric form*
$\tilde{J}(f):= \frac{1}{N_d}(\sum \ln r_\nu(f(x^{(d)}_i)-\ln p_n(x^{(d)}_i))+\sum \ln (1-r_\nu(f(x^{(n)}_i)-\ln p_n(x^{(n)}_i))))$

*Remark.* A fundamental point in the theorem isthat the maximization is performed without any normalization constraint for $f$


$$
\nabla J_T = \frac{1}{N_d}\sum (1-h(x^{(d)}_i))g(x^{(d)}_i) + \nu\frac{1}{N_n}\sum h(x^{(n)}_i) g(x^{(n)}_i)\\
g := \nabla G = \nabla \ln p_m
$$

for NCE
$g=(\nabla_\alpha G, 1)^T$

## Properties

**Th1**
$\tilde{J}$ attains max at $f=p_d$. No other ext, if $p_d\ll p_n$